@page
@model api.Pages.Admin.Orders.IndexModel
@{
    ViewData["Title"] = "Orders Management";
    ViewData["PageTitle"] = "Orders";
}

<div class="space-y-6">
    <div class="bg-[#1E293B] rounded-xl shadow-md overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-700">
            <h3 class="text-lg font-semibold text-white">Orders List</h3>
        </div>

        <div class="overflow-x-auto">
            <table class="w-full">
                <thead class="bg-gray-800">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">ID
                        </th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">
                            Order-Id</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">
                            User-Name</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">
                            Status</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">
                            Total-Amount</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">
                            Payment-Method</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">
                            Actions</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-700">
                    @for (int i = 0; i < Model.Orders.Count; i++)
                    {
                        var order = Model.Orders[i];
                        <tr class="hover:bg-gray-800 transition-colors">
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">@((Model.CurrentPage - 1) *
                                                            Model.Size + i + 1)</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div>
                                <div class="text-sm font-medium text-white">@order._id</div>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                            @order.user.name
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">
                            @{
                                var status = order.status?.ToLower();
                                var statusClass = status == "pending" ? "border-[#FBBF24] text-[#FBBF24]"
                                : status == "processing" ? "border-[#3B82F6] text-[#3B82F6]"
                                : status == "shipped" ? "border-[#8B5CF6] text-[#8B5CF6]"
                                : status == "delivered" ? "border-[#22C55E] text-[#22C55E]"
                                : "border-[#EF4444] text-[#EF4444]";

                                var statusText = status == "pending" ? "Pending"
                                : status == "processing" ? "Processing"
                                : status == "shipped" ? "Shipped"
                                : status == "delivered" ? "Delivered"
                                : "Cancelled";
                            }
                            <span class="px-3 py-1 text-xs font-medium rounded-full border @statusClass">
                                @statusText
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                            @($"{order.totalAmount:N0}Ä‘")
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            @{
                                var paymentMethod = order.paymentMethod.ToLower();
                                var paymentClass = paymentMethod == "stripe" ? "bg-[#635BFF] text-white"
                                : paymentMethod == "momo" ? "bg-[#D82D8B] text-white"
                                : "bg-[#4CAF50] text-white";
                                var paymentText = paymentMethod == "stripe" ? "Stripe"
                                : paymentMethod == "momo" ? "Momo"
                                : "Ship-cod";
                            }
                            <span class="px-4 py-2 text-xs font-medium rounded-full @paymentClass">
                                @paymentText
                            </span>
                        </td>

                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <div class="flex space-x-2">
                                <a href="/Admin/Orders/Details/@order._id" class="text-[#1E88E5] hover:text-[#1E88E5]">
                                    <i data-lucide="eye" class="w-4 h-4"></i>
                                </a>
                                <a href="/Admin/Orders/Update/@order._id"
                                    class="text-[#fdcf00fd] hover:text-[#fdcf00fd]">
                                    <i data-lucide="shield-check" class="w-4 h-4"></i>
                                </a>
                            </div>
                        </td>
                    </tr>
                   }
                </tbody>
            </table>
        </div>
    </div>

    @if (Model.TotalPages > 1)
    {
        var current = Model.CurrentPage;
        var size = Model.Size;
        var totalPages = Model.TotalPages;

        <div class="flex justify-center items-center gap-4 mt-6">
            <a class="px-3 py-2 border border-gray-700 bg-gray-800 text-gray-300 rounded-md @(current <= 1 ? "opacity-50 pointer-events-none" : "hover:bg-gray-700")"
                href="?page=@(current - 1)&size=@size">
                Previous
            </a>

            <span class="text-sm text-gray-400">
                Page <span class="font-semibold text-white">@current</span> of <span
                    class="font-semibold text-white">@totalPages</span>
            </span>

            <a class="px-3 py-2 border border-gray-700 bg-gray-800 text-gray-300 rounded-md @(current >= totalPages ? "opacity-50 pointer-events-none" : "hover:bg-gray-700")"
                href="?page=@(current + 1)&size=@size">
                Next
            </a>
        </div>
    }

</div>
